<%- include("../partials/header") %>

<div class="container py-4" style="max-width:900px;">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h3 class="fw-bold text-success mb-0">
        <%= patient.first_name %> <%= patient.last_name %>
      </h3>
      <div class="text-muted small">
        <%= patient.gender || "—" %>
        <% if (patient.age) { %> • <%= patient.age %> yrs <% } %>
      </div>
    </div>

    <div>
      <a href="/patients/<%= patient.patient_id %>/edit"
        class="btn btn-sm btn-outline-primary border mb-1">
        Edit</a>


      <button class="btn btn-outline-danger btn-sm"
        data-bs-toggle="modal"
        data-bs-target="#deletePatientModal">
        Delete
      </button>

    </div>
  </div>

  <!-- SYSTEMIC -->
  <div class="card border-0 shadow-sm mb-3 p-3">
    <div class="fw-semibold mb-1">Systemic Diseases / Surgical History</div>
    <div class="text-muted small">
      Systemic Diseases: <%= patient.systemic_condition || "—" %><br>
      Surgeries: <%= patient.ocular_surgery || "—" %>
    </div>
  </div>

  <!-- VISUAL ACUITY -->
    <div class="card border-0 shadow-sm mb-3 p-3">
    <div class="fw-semibold mb-3 text-center">Visual Acuity</div>

    <div class="row text-center fw-semibold mb-1">
        <div class="col-4"></div>
        <div class="col-4">OD</div>
        <div class="col-4">OS</div>
    </div>

    <div class="row text-center mb-1">
        <div class="col-4 fw-semibold">VA</div>
        <div class="col-4"><%= patient.va_od || "—" %></div>
        <div class="col-4"><%= patient.va_os || "—" %></div>
    </div>

    <div class="row text-center">
        <div class="col-4 fw-semibold">PH</div>
        <div class="col-4"><%= patient.ph_od || "—" %></div>
        <div class="col-4"><%= patient.ph_os || "—" %></div>
    </div>
    </div>
  <!-- SUBJECTIVE REFRACTION -->
  <div class="card border-0 shadow-sm mb-3 p-3">
    <div class="fw-semibold mb-3 text-center">Subjective Refraction</div>

    <div class="row text-center fw-semibold mb-1">
        <div class="col-4"></div>
        <div class="col-4">OD</div>
        <div class="col-4">OS</div>
    </div>

    <div class="row text-center mb-1">
        <div class="col-4 fw-semibold">Sphere</div>
        <div class="col-4"><%= patient.sph_od_sub ?? "—" %></div>
        <div class="col-4"><%= patient.sph_os_sub ?? "—" %></div>
    </div>

    <div class="row text-center mb-1">
        <div class="col-4 fw-semibold">Cylinder</div>
        <div class="col-4"><%= patient.cyl_od_sub ?? "—" %></div>
        <div class="col-4"><%= patient.cyl_os_sub ?? "—" %></div>
    </div>

    <div class="row text-center mb-1">
        <div class="col-4 fw-semibold">Axis</div>
        <div class="col-4"><%= patient.axis_od_sub ?? "—" %></div>
        <div class="col-4"><%= patient.axis_os_sub ?? "—" %></div>
    </div>

    <div class="row text-center mb-1">
        <div class="col-4 fw-semibold">VA</div>
        <div class="col-4"><%= patient.va_od_sub || "—" %></div>
        <div class="col-4"><%= patient.va_os_sub || "—" %></div>
    </div>

    <div class="row text-center">
        <div class="col-4 fw-semibold">ADD</div>
        <div class="col-4"><%= patient.add_od ?? "—" %></div>
        <div class="col-4"><%= patient.add_os ?? "—" %></div>
    </div>
</div>



  <!-- DIAGNOSIS -->
  <div class="card border-0 shadow-sm p-3">
    <div class="fw-semibold mb-1">Diagnosis</div>
    <div class="text-muted">
      <%= patient.diagnosis || "—" %>
    </div>
  </div>



    <!-- CLINICAL NOTES -->
  <div class="card border-0 shadow-sm p-3">
    <div class="fw-semibold mb-1">Clinical notes</div>
    <div class="text-muted">
      <%= patient.current_health_status || "—" %>
      <hr>
       <%= patient.notes || "—" %>
    </div>
  </div>
</div>



<!-- DELETE MODAL -->
<div class="modal fade" id="deletePatientModal">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center p-4">

      <div class="mb-3">
        <i class="fas fa-exclamation-triangle text-danger fa-2x"></i>
      </div>

      <h5 class="mb-2">Delete patient record?</h5>
      <div class="text-muted small mb-4">
        This action cannot be undone
      </div>

      <form action="/patients/<%= patient.patient_id %>/delete"
            method="POST">
        <button class="btn btn-danger px-4 me-2">
          Yes, Delete
        </button>

        <button type="button"
                class="btn btn-light border"
                data-bs-dismiss="modal">
          Cancel
        </button>
      </form>

    </div>
  </div>
</div>


<%- include("../partials/footer") %>
